# 人工智能量化投资项目

本仓库包含两个基于机器学习和深度学习的项目，分别针对时间序列预测和股票选股进行了初步探索和建模。这两个项目旨在通过不同的机器学习方法，利用历史数据预测未来走势或产生买入信号，为量化投资策略提供数据支持。

## 项目概览

1. **机器学习预测时间序列**  
   利用COVID-19相关数据（例如：累计测试人数增长、阳性测试增长以及死亡增长等指标），构建回归模型，对时间序列数据进行预测。项目中采用了多种回归模型：
   - 支持向量机（SVM）回归
   - 决策树回归
   - 基于 Keras 搭建的神经网络（深度学习）模型  
   通过归一化数据、构造特征和目标值，并对训练集与测试集进行划分，最终计算均方误差（MSE），评估各模型表现。

2. **优矿选股**  
   针对股票历史交易数据，构建量化选股策略。项目中通过对交易数据生成买入信号（例如：当涨跌幅 `CHG` 大于 0 且 `CHGPct` 大于 0.01 时定义为买入信号），利用分类算法预测股票的买入信号。主要模型包括：
   - 支持向量机（SVM）分类器
   - 决策树分类器
   - 基于 Keras 搭建的神经网络分类器  
   数据预处理、特征归一化、训练集和测试集切分等流程均已包含在代码中，同时也提供了新数据的预测示例。

## 项目 1：机器学习预测时间序列

### 数据说明

本项目使用的时间序列数据包含如下字段（部分示例数据）：

| 字段名称                | 说明                                       |
| ----------------------- | ------------------------------------------ |
| state                   | 州名（如 Alaska、New York 等）              |
| date                    | 日期（例如：2020/3/6）                        |
| 总人口                  | 各州总人口数                                |
| 累积测试人数            | 户累计测试人数                             |
| 每1000人中累积测试人数   | 每千人的累积测试比例                         |
| 总计测试人数增长         | 每日新增总测试人数                           |
| 累积测试阳性             | 累计新增阳性测试人数                         |
| 阳性测试增长             | 每日新增阳性测试数                           |
| 累积测试阴性             | 累计测试阴性数据                            |
| 累积阳性概率             | 累计的阳性比例                              |
| 累积死亡人数             | 累计死亡人数                                |
| 每100000中死亡人数       | 每10万人口的死亡数                           |
| 死亡增长                | 每日新增死亡人数                            |

#### 主要预处理步骤

- **数据过滤**：对数据进行筛选，比如针对特定州（如 New York）进行过滤。
- **特征提取**：从数据中提取 `总计测试人数增长`、`阳性测试增长` 作为特征，以及 `死亡增长` 作为目标值。
- **标准化处理**：利用 `MinMaxScaler` 对特征数据进行归一化处理。
- **数据拆分**：按时间顺序划分训练集与测试集（例如，使用部分数据作为模型训练，最后一部分数据作为测试）。

### 模型构建与评估

本项目采用以下三种回归模型，并通过均方误差（Mean Squared Error, MSE）评估模型表现：

1. **SVM 回归模型**  
   - **模型**：`sklearn.svm.SVR`  
   - **流程**：用训练数据拟合模型后，对测试数据进行预测，并计算 MSE。

2. **决策树回归模型**  
   - **模型**：`sklearn.tree.DecisionTreeRegressor`  
   - **流程**：对训练集进行训练，预测测试集，并计算 MSE。

3. **神经网络回归模型**  
   - **模型构建**：使用 Keras 搭建一个含两个隐藏层的全连接网络，每层包含 128 个神经元，采用 ReLU 激活函数；输出层为一个神经元，用于预测数值。
   - **编译与训练**：使用 `binary_crossentropy` 作为损失函数（注：对回归问题建议使用 MSE 或 MAE，根据业务需求调整），采用 Adam 优化器进行训练。
   - **数据反归一化**：训练结束后，将预测值与测试目标值进行反归一化处理，再计算 MSE。

---

## 项目 2：优矿选股

### 数据说明

股票历史交易数据包含如下关键信息（部分示例数据）：

| 字段名称         | 说明                                      |
| ---------------- | ----------------------------------------- |
| secID            | 证券代码                                   |
| ticker           | 股票代码                                   |
| exchangeCD       | 交易所在的市场代码                          |
| secShortName     | 股票简称                                   |
| tradeDate        | 交易日期                                   |
| preClosePrice    | 前一交易日收盘价                            |
| openPrice        | 当日开盘价                                 |
| highestPrice     | 当日最高价                                 |
| lowestPrice      | 当日最低价                                 |
| closePrice       | 当日收盘价                                 |
| CHG              | 涨跌幅（数值）                              |
| CHGPct           | 涨跌幅（百分比）                            |
| turnoverVol      | 成交量                                     |
| turnoverValue    | 成交金额                                   |
| discount         | 折让率                                     |
| circulationShares| 流通股数                                   |
| accumAdjFactor   | 复权因子                                   |

#### 主要预处理与特征工程

- **买入信号生成**：  
  根据规则生成买入信号列。例如，当 `CHG > 0` 且 `CHGPct > 0.01` 时定义为买入信号（值为 1），否则为 0。
  
- **特征选择与标准化**：  
  选择与交易相关的八个主要特征：`preClosePrice`、`openPrice`、`highestPrice`、`lowestPrice`、`closePrice`、`CHG`、`CHGPct`、`turnoverVol`。使用 `MinMaxScaler` 进行归一化处理。

- **数据拆分**：  
  将数据划分为训练集和测试集以便模型训练和评估。

### 模型构建与评估

本项目依次实现了以下三种分类模型，用于预测买入信号，并计算分类准确率：

1. **SVM 分类器**  
   - **模型**：`sklearn.svm.SVC`  
   - **流程**：训练模型后，在测试集上进行预测，并使用 `accuracy_score` 衡量预测准确率。

2. **决策树分类器**  
   - **模型**：`sklearn.tree.DecisionTreeClassifier`  
   - **流程**：对训练集进行训练，预测测试集数据，并计算分类准确率。

3. **神经网络分类器**  
   - **模型构建**：使用 Keras 构建深度神经网络。  
     - 两个全连接隐藏层，每层均包含 128 个神经元，激活函数为 ReLU；
     - 输出层采用 Sigmoid 激活函数，输出买入信号的概率。
   - **编译与训练**：使用 `binary_crossentropy` 损失函数及 Adam 优化器进行编译和训练。
   - **评估与预测**：训练完成后，在测试集上计算预测准确率，并提供独立新样本数据的预测示例，输出买入信号概率。

---


---

## 3. 实验结论与讨论

- **SVM 与决策树回归模型**  
两种传统回归方法在本实验中表现良好，且决策树回归模型获得的 MSE 最低（约 0.00085），显示出较强的预测能力。

---
  

